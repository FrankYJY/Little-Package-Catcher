<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
    <!-- Generated by javadoc (1.8.0_144) on Mon Apr 08 12:16:39 CST 2019 -->
    <title>org.jnetpcap.packet</title>
    <meta name="date" content="2019-04-08">
    <link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
    <script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
try {
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title = "org.jnetpcap.packet";
    }
} catch (err) {
}
//-->
</script>
<noscript>
    <div>����������ѽ��� JavaScript��</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
    <!--   -->
</a>
    <div class="skipNav"><a href="#skip.navbar.top" title="������������">������������</a></div>
    <a name="navbar.top.firstrow">
        <!--   -->
    </a>
    <ul class="navList" title="����">
        <li><a href="../../../overview-summary.html">����</a></li>
        <li class="navBarCell1Rev">�����</li>
        <li>��</li>
        <li><a href="package-use.html">ʹ��</a></li>
        <li><a href="package-tree.html">��</a></li>
        <li><a href="../../../deprecated-list.html">�ѹ�ʱ</a></li>
        <li><a href="../../../index-files/index-1.html">����</a></li>
        <li><a href="../../../help-doc.html">����</a></li>
    </ul>
</div>
<div class="subNav">
    <ul class="navList">
        <li><a href="../../../org/jnetpcap/nio/package-summary.html">��һ�������</a></li>
        <li><a href="../../../org/jnetpcap/packet/annotate/package-summary.html">��һ�������</a></li>
    </ul>
    <ul class="navList">
        <li><a href="../../../index.html?org/jnetpcap/packet/package-summary.html" target="_top">���</a></li>
        <li><a href="package-summary.html" target="_top">�޿��</a></li>
    </ul>
    <ul class="navList" id="allclasses_navbar_top">
        <li><a href="../../../allclasses-noframe.html">������</a></li>
    </ul>
    <div>
        <script type="text/javascript"><!--
        allClassesLink = document.getElementById("allclasses_navbar_top");
        if (window == top) {
            allClassesLink.style.display = "block";
        } else {
            allClassesLink.style.display = "none";
        }
        //-->
        </script>
    </div>
    <a name="skip.navbar.top">
        <!--   -->
    </a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
    <h1 title="�����" class="title">�����&nbsp;org.jnetpcap.packet</h1>
    <div class="docSummary">
        <div class="block">Packet decoding framework.</div>
    </div>
    <p>�����:&nbsp;<a href="#package.description">˵��</a></p>
</div>
<div class="contentContainer">
    <ul class="blockList">
        <li class="blockList">
            <table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="�ӿڸ�Ҫ��, �б�ӿںͽ���">
                <caption><span>�ӿڸ�Ҫ</span><span class="tabEnd">&nbsp;</span></caption>
                <tr>
                    <th class="colFirst" scope="col">�ӿ�</th>
                    <th class="colLast" scope="col">˵��</th>
                </tr>
                <tbody>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JBinding.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JBinding</a></td>
                    <td class="colLast">
                        <div class="block">A bindinding between two protocol headers.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JCompoundHeader.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JCompoundHeader</a>&lt;B extends <a
                            href="../../../org/jnetpcap/packet/JHeader.html"
                            title="org.jnetpcap.packet�е���">JHeader</a>&gt;
                    </td>
                    <td class="colLast">
                        <div class="block">The Interface JCompoundHeader.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JDependency.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JDependency</a></td>
                    <td class="colLast">
                        <div class="block">Lists binding's protocol dependencies.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeaderAccessor.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JHeaderAccessor</a></td>
                    <td class="colLast">
                        <div class="block">Accessor to get a structured header from underlying buffer.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeaderChecksum.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JHeaderChecksum</a></td>
                    <td class="colLast">
                        <div class="block">Interface implemented by protocol headers that maintain a header and possibly
                            payload checksums.
                        </div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeaderType.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JHeaderType</a></td>
                    <td class="colLast">
                        <div class="block">The Interface JHeaderType.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JPacketHandler.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JPacketHandler</a>&lt;T&gt;
                    </td>
                    <td class="colLast">
                        <div class="block">A dispatchable packet hadler.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JPayloadAccessor.html"
                                            title="org.jnetpcap.packet�еĽӿ�">JPayloadAccessor</a></td>
                    <td class="colLast">
                        <div class="block">Interface which provides access to payload portion of the packet data.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/PcapPacketHandler.html"
                                            title="org.jnetpcap.packet�еĽӿ�">PcapPacketHandler</a>&lt;T&gt;
                    </td>
                    <td class="colLast">
                        <div class="block">The Interface PcapPacketHandler.</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </li>
        <li class="blockList">
            <table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="���Ҫ��, �б���ͽ���">
                <caption><span>���Ҫ</span><span class="tabEnd">&nbsp;</span></caption>
                <tr>
                    <th class="colFirst" scope="col">��</th>
                    <th class="colLast" scope="col">˵��</th>
                </tr>
                <tbody>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/AbstractBinding.html"
                                            title="org.jnetpcap.packet�е���">AbstractBinding</a>&lt;H extends <a
                            href="../../../org/jnetpcap/packet/JHeader.html"
                            title="org.jnetpcap.packet�е���">JHeader</a>&gt;
                    </td>
                    <td class="colLast">
                        <div class="block">The Class AbstractBinding.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/AbstractMessageHeader.html"
                                            title="org.jnetpcap.packet�е���">AbstractMessageHeader</a></td>
                    <td class="colLast">
                        <div class="block">The Class AbstractMessageHeader.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JBinding.DefaultJBinding.html"
                                            title="org.jnetpcap.packet�е���">JBinding.DefaultJBinding</a></td>
                    <td class="colLast">
                        <div class="block">An abstract adaptor that provides a default implementation for a binding.
                        </div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JFlow.html"
                                            title="org.jnetpcap.packet�е���">JFlow</a></td>
                    <td class="colLast">
                        <div class="block">The Class JFlow.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JFlowKey.html"
                                            title="org.jnetpcap.packet�е���">JFlowKey</a></td>
                    <td class="colLast">
                        <div class="block">A unique key that identifies a flow of related packets.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JFlowMap.html"
                                            title="org.jnetpcap.packet�е���">JFlowMap</a></td>
                    <td class="colLast">
                        <div class="block">The Class JFlowMap.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeader.html"
                                            title="org.jnetpcap.packet�е���">JHeader</a></td>
                    <td class="colLast">
                        <div class="block">A base class for all protocol header definitions.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeader.State.html"
                                            title="org.jnetpcap.packet�е���">JHeader.State</a></td>
                    <td class="colLast">
                        <div class="block">This class is peered state of a header a native state structure


                            typedef struct header_t {
                            uint8_t hdr_id; // header ID

                            uint8_t hdr_prefix; // length of the prefix (preamble) before the header
                            uint8_t hdr_gap; // length of the gap between header and payload
                            uint16_t hdr_flags; // flags for this header
                            uint16_t hdr_postfix; // length of the postfix (trailer) after the payload
                            uint32_t hdr_offset; // offset into the packet_t-&gt;data buffer
                            uint32_t hdr_length; // length of the header in packet_t-&gt;data buffer
                            uint32_t hdr_payload; // length of the payload

                            jobject hdr_analysis; // Java JAnalysis based object if not null
                            } header_t;


                            .
                        </div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeaderMap.html"
                                            title="org.jnetpcap.packet�е���">JHeaderMap</a>&lt;B extends <a
                            href="../../../org/jnetpcap/packet/JHeader.html"
                            title="org.jnetpcap.packet�е���">JHeader</a>&gt;
                    </td>
                    <td class="colLast">
                        <div class="block">The Class JHeaderMap.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeaderPool.html"
                                            title="org.jnetpcap.packet�е���">JHeaderPool</a></td>
                    <td class="colLast">
                        <div class="block">A thread local pool of instances of headers.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JHeaderScanner.html"
                                            title="org.jnetpcap.packet�е���">JHeaderScanner</a></td>
                    <td class="colLast">
                        <div class="block">A header scanner, there is one per header, that is able to scan raw memory
                            buffer and determine the length of the header and the next header ID after
                            examining the current header's structure.
                        </div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JMappedHeader.html"
                                            title="org.jnetpcap.packet�е���">JMappedHeader</a></td>
                    <td class="colLast">
                        <div class="block">The Class JMappedHeader.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JMappedHeader.Entry.html"
                                            title="org.jnetpcap.packet�е���">JMappedHeader.Entry</a></td>
                    <td class="colLast">
                        <div class="block">The Class Entry.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JMemoryPacket.html"
                                            title="org.jnetpcap.packet�е���">JMemoryPacket</a></td>
                    <td class="colLast">
                        <div class="block">A heap based packet.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JMemoryPacket.JMemoryHeader.html"
                                            title="org.jnetpcap.packet�е���">JMemoryPacket.JMemoryHeader</a></td>
                    <td class="colLast">
                        <div class="block">A capture header that stores information about the creation of the packet.
                        </div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JPacket.html"
                                            title="org.jnetpcap.packet�е���">JPacket</a></td>
                    <td class="colLast">
                        <div class="block">A native packet buffer object.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JPacket.State.html"
                                            title="org.jnetpcap.packet�е���">JPacket.State</a></td>
                    <td class="colLast">
                        <div class="block">Class maintains the decoded packet state.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JRegistry.html"
                                            title="org.jnetpcap.packet�е���">JRegistry</a></td>
                    <td class="colLast">
                        <div class="block">A registry of protocols, their classes, runtime IDs and bindings.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JRegistry.Entry.html"
                                            title="org.jnetpcap.packet�е���">JRegistry.Entry</a></td>
                    <td class="colLast">
                        <div class="block">A header information entry created for every header registered.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JScan.html"
                                            title="org.jnetpcap.packet�е���">JScan</a></td>
                    <td class="colLast">
                        <div class="block">A inprogress working scan structure.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JScanner.html"
                                            title="org.jnetpcap.packet�е���">JScanner</a></td>
                    <td class="colLast">
                        <div class="block">JMemory with struct scanner_t, binding_t, packet_t and header_t structures.
                        </div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JScannerReference.html"
                                            title="org.jnetpcap.packet�е���">JScannerReference</a></td>
                    <td class="colLast">
                        <div class="block">The Class JScannerReference.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/JSubHeader.html"
                                            title="org.jnetpcap.packet�е���">JSubHeader</a>&lt;T extends <a
                            href="../../../org/jnetpcap/packet/JHeader.html"
                            title="org.jnetpcap.packet�е���">JHeader</a>&gt;
                    </td>
                    <td class="colLast">
                        <div class="block">The Class JSubHeader.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/Payload.html"
                                            title="org.jnetpcap.packet�е���">Payload</a></td>
                    <td class="colLast">
                        <div class="block">Builtin header type that is a catch all for all unmatch data within a packet
                            buffer.
                        </div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/PcapPacket.html"
                                            title="org.jnetpcap.packet�е���">PcapPacket</a></td>
                    <td class="colLast">
                        <div class="block">A pcap packet.</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </li>
        <li class="blockList">
            <table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="ö�ٸ�Ҫ��, �б�ö�ٺͽ���">
                <caption><span>ö�ٸ�Ҫ</span><span class="tabEnd">&nbsp;</span></caption>
                <tr>
                    <th class="colFirst" scope="col">ö��</th>
                    <th class="colLast" scope="col">˵��</th>
                </tr>
                <tbody>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/AbstractMessageHeader.MessageType.html"
                                            title="org.jnetpcap.packet�е�ö��">AbstractMessageHeader.MessageType</a></td>
                    <td class="colLast">
                        <div class="block">The Enum MessageType.</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </li>
        <li class="blockList">
            <table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="�쳣�����Ҫ��, �б��쳣����ͽ���">
                <caption><span>�쳣�����Ҫ</span><span class="tabEnd">&nbsp;</span></caption>
                <tr>
                    <th class="colFirst" scope="col">�쳣����</th>
                    <th class="colLast" scope="col">˵��</th>
                </tr>
                <tbody>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/PeeringException.html"
                                            title="org.jnetpcap.packet�е���">PeeringException</a></td>
                    <td class="colLast">
                        <div class="block">The Class PeeringException.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/RegistryException.html"
                                            title="org.jnetpcap.packet�е���">RegistryException</a></td>
                    <td class="colLast">
                        <div class="block">The Class RegistryException.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/RegistryHeaderErrors.html"
                                            title="org.jnetpcap.packet�е���">RegistryHeaderErrors</a></td>
                    <td class="colLast">
                        <div class="block">The Class RegistryHeaderErrors.</div>
                    </td>
                </tr>
                <tr class="rowColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/RegistryRuntimeException.html"
                                            title="org.jnetpcap.packet�е���">RegistryRuntimeException</a></td>
                    <td class="colLast">
                        <div class="block">The Class RegistryRuntimeException.</div>
                    </td>
                </tr>
                <tr class="altColor">
                    <td class="colFirst"><a href="../../../org/jnetpcap/packet/UnregisteredHeaderException.html"
                                            title="org.jnetpcap.packet�е���">UnregisteredHeaderException</a></td>
                    <td class="colLast">
                        <div class="block">Thrown when a lookup on a header in JRegistry fails.</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </li>
    </ul>
    <a name="package.description">
        <!--   -->
    </a>
    <h2 title="�����org.jnetpcap.packet��˵��">�����org.jnetpcap.packet��˵��</h2>
    <div class="block">Packet decoding framework. Packet buffers are scanned and decoded.

        <h2>Overview</h2>
        The package adds new
        <code>loop</code>
        and
        <code>dispatch</code>
        methods that deliver decoded packets to the registered handler. The
        class JPacket allows the programmer to check for existance of certain
        protocol headers within the packet's data buffer. The programmer can use
        a header to then access any of the fields and logic for that protocol.
        <p>Here is an example of what a JPacketHandler might look like:
        <pre>
JPacketHandler<String> handler = new JPacketHandler<String>() {
  private Ethernet eth = new Ethernet();
  private Ip4 ip = new Ip4();
  
  public void nextPacket(JPacket packet, String user) {
    if (packet.hasHeader(Ethernet.ID)) {
      eth = packet.getHeader(eth);
      byte[] dstMac = eth.destination();
      byte[] srcMac = eth.source();
      int type = eth.type();
      // Do something
    }
    
    /*
     * For convenience there is a hasHeader method that takes a header instance
     * and combines hasHeader with getHeader methods if the header exists.
     */
    if (packet.hasHeader(ip)) {      
      int flags = ip.flags();
      int offset = ip.offset();
      byte[] srcIp = ip.source();
      byte[] dstIp = ip.destination();
      int protocol = ip.protocol();
    }
    
    // Or can simply print out the contents of the packet
    System.out.println(packet.toString());
  }
}
</pre>
        The example demonstates a
        <code>JPacketHandler</code>
        implementation, which gets passed into
        <code>loop/dispatch</code>
        methods and receives packets. The handler's
        <code>nextPacket</code>
        method receives a fully decoded packet. The information about which
        headers exist, where in the buffer and how long they are is recorded in
        native structures which
        <code>JPacket, JPacket.State, JHeader, JHeader.State</code>
        classes access. The method
        <code>JPacket.hasHeader</code>
        is a simply bitwise operation on an unsigned integer that is very
        efficient and fast.
        </p>
        <p>The typical steps for working with the packet objects is first to
            check if the header the user is insterested in exists in the packet, has
            been found by the packet scanner, and then request that user supplied
            header instance is peered with the native structures that describe that
            header.(Peering means that the physical address of the native structure
            is recorded somewhere in the java class beeing peered and afterwards
            that class uses that pointer to access and retrieve data from the
            physical native structure or buffer.)
        <h2><a
                href="https://sourceforge.net/tracker2/?func=detail&aid=2292402&group_id=164277&atid=831086">Feature
            #2292402:</a> A packet decoding framework</h2>
        This feature "packet decoding framework" extends basic jNetPcap
        capabilities of capturing a network packet or reading it from an offline
        file, then delivering that packet as a raw byte buffer to a PcapHandler
        which is a user provided callback object. The packet framework adds
        additional capabilities where the raw byte buffer is decoded into an
        array of headers contained within a PcapPacket or more commonly a super
        class JPacket.
        <p>The framework provides additional <code>Pcap.loop and
            Pcap.dispatch</code> methods which allow the user to supply a <code>JPacketHandler</code>,
            as opposed to <code>PcapHandler</code>, which delivers a decoded <code>JPacket</code>
            object to the user's callback method <code>JPacketHandler.nextPacket(JPacket
                packet, Object user)</code></p>
        <p><code>JPacket</code> class is the main interface to the decoded
            packet information, specifically; which protocol headers exist in the
            packet, found by scanning the raw byte buffer, and detailed information
            on those headers. The user can query a <code>JPacket</code> using
            methods <code>JPacket.hasHeader(int id)</code>, <code>JPacket.getHeader(T
                header):&lt;T extends JHeader&gt; T</code> and <code>JPacket.getCaptureHeader()</code>
            which returns the capture information such as timestamp and wirele
            (length of the packet as seen on the network wire.)</p>
        <p>There are also numerous support and other implementation classes
            such as
        <ul>
            <li>JRegistry - is a singleton class where all the protocol
                headers and inter protocol bindings are registered. JRegistry also
                maintains and assigns numerical protocol IDs. These are dynamically
                assigned IDs that have no relationship to IDs in PcapDLT or libpcap
                header files.
            </li>

            <li>JScanner - concrete class that performs the actual scan of the
                contents of the raw packet buffer. This class records this information
                in native structures which are then associated with JPacket and JHeader
                objects (peered with.)
            </li>

            <li>JProtocol - an enum table that lists all of the core protocols
                provided by jNetPcap API.
            </li>
            <li>JBinding - class that allows new inter protocol bindings to be
                registered or override any existing bindings already set, even on core
                protocols. You use this class to define how one protocol is bound to
                another. For example you can bind HTML protocol header on a different
                port, other than the defacto standard 80. As a matter of fact you can
                supply any kind of logic using this class which will determine the next
                protocol header that should follow the one that the binding was bound
                to.
            </li>
        </ul>
        <h3>Advanced: Scanner implementation details</h3>
        It is time to discuss the JScanner class and how it works behind the
        scenes. The scanner is actually implemented completely in native code.
        It is a tight loop that scans the raw packet buffer (an array of raw
        bytes or chars using C symantics) starting at the begining of the buffer
        and assuming what the first header is, which is specified to it from
        java space (can be automatically discovered using Pcap.datalink() method
        or user supplied). The scanner uses numerical ids, assigned and
        maintained by JRegistry, in the scanning and recoding process. As
        headers are discovered information about those headers is recorded.
        <p>The scanner implementation is almost completely in native code.
            The scanner when its initialized allocates a large native memory block
            to hold its state and state about every packet it decodes. A pointer
            into the buffer is maintained which points to memory space where packet
            state can be recorded. Pointer is advanced for each packet that is being
            scanned. When the buffer is exhausted and the end is reached, the buffer
            simply wraps around to the beginning and the buffer is reused. This is
            the same algorithm that native libpcap uses for its capture buffer. So
            both the raw packet buffer, maintained by libpcap, and the packet
            decoded state information, maintained by JScanner, are kept in
            temporary, roundrobin buffers. This is something that also applies to
            other Pcap.loop and Pcap.dispatch methods that only dispatch raw byte
            buffers.
        <p>As packets arrive and the scanner is asked to scan them, it
            increments a pointer to a packet_state_t structure, within its buffer.
            The packet_state_t structure is where information is recorded about each
            headers. First there is a compress bitmap which using header's numerical
            IDs, records information about the presence of a header by setting a bit
            in this bitmap (an unsigned integer). Calls to JPacket.hasHeader(int id)
            simply check if a bit is set for a specific header ID and return true or
            false. Therefore JPacket.hasHeader checks are very light and fast and
            can be made frequently without having to worry about performance.
            Secondly, the scanner also records header's position within the buffer
            and the header's length. That information is also recorded in
            packet_state_t which has a header_state_t array member. The last header
            is typically a payload header, a special header that is catch all and
            captures the remainder of the packet that was not matched with any
            protocol header.</p>
        <h3>Native JScanner structures</h3>
        <p>Before we begin on native structures, lets look at the class
            inheritance tree.
        <pre>
jMemory
+-> JBuffer 
|   +-> JPacket - peered with libpcap packet data buffer
|
+-> JStruct
    +-> JPacket.State - peered with JScanners packet_state_t structure
    +-> JHeader.State - peered with JScanners header_state_t structure
</pre>
        Further more, JPacket maintains an internal reference to a JPacket.State
        object as a private field. That is JPacket is peered with libpcap packet
        buffer, while a separate JPacket.State object is peered with the
        JScanner packet state structure. Notice that JPacket extends JBuffer,
        therefore any JPacket can be used as a normal JBuffer providing full
        access to all of the packets raw contents. The state information is
        allocated and maintained by JScanner.
        </p>
        <p>Packets are assigned a packet_state_t structure by peering a java
            class with this native memory structure. jNetPcap uses the concept of
            native peers by holding the physical memory address as a internal
            private field within the java object. Native functions when called upon,
            retrieve this address location, cast a local pointer to that physical
            memory location for the structure that the class is peered with and then
            access that information. So a JPacket.State object is peered with a
            packet_state_t structure (residing in native memory) by simply changing
            a single java field. Java objects that are peered, hold very little
            additional information about the structure. There are some additional
            fields that are maintained for security purposes such as the size of the
            memory block and who the java owner of that memory block is. This
            information is only maintained for security and deallocation of memory
            purposes when the java parent object is garbage collected. This peering
            mechanism allows previously allocated packets to be reused extrememly
            efficiently, by simply changing a single pointer to a packet_state_t
            structure within it and changing the state of the packet immediately.
            JHeaders also maintain their state in this way.</p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
    <!--   -->
</a>
    <div class="skipNav"><a href="#skip.navbar.bottom" title="������������">������������</a></div>
    <a name="navbar.bottom.firstrow">
        <!--   -->
    </a>
    <ul class="navList" title="����">
        <li><a href="../../../overview-summary.html">����</a></li>
        <li class="navBarCell1Rev">�����</li>
        <li>��</li>
        <li><a href="package-use.html">ʹ��</a></li>
        <li><a href="package-tree.html">��</a></li>
        <li><a href="../../../deprecated-list.html">�ѹ�ʱ</a></li>
        <li><a href="../../../index-files/index-1.html">����</a></li>
        <li><a href="../../../help-doc.html">����</a></li>
    </ul>
</div>
<div class="subNav">
    <ul class="navList">
        <li><a href="../../../org/jnetpcap/nio/package-summary.html">��һ�������</a></li>
        <li><a href="../../../org/jnetpcap/packet/annotate/package-summary.html">��һ�������</a></li>
    </ul>
    <ul class="navList">
        <li><a href="../../../index.html?org/jnetpcap/packet/package-summary.html" target="_top">���</a></li>
        <li><a href="package-summary.html" target="_top">�޿��</a></li>
    </ul>
    <ul class="navList" id="allclasses_navbar_bottom">
        <li><a href="../../../allclasses-noframe.html">������</a></li>
    </ul>
    <div>
        <script type="text/javascript"><!--
        allClassesLink = document.getElementById("allclasses_navbar_bottom");
        if (window == top) {
            allClassesLink.style.display = "block";
        } else {
            allClassesLink.style.display = "none";
        }
        //-->
        </script>
    </div>
    <a name="skip.navbar.bottom">
        <!--   -->
    </a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
